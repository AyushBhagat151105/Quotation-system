import{j as e,t as u,k as p}from"./index-CjKGLORb.js";import{u as h}from"./useQuery-vpdnFCOo.js";import{q as l}from"./quotation-B4L4haJ9.js";import{u as x,t as b,a as g,I as r}from"./zod-Dl1H6Aq1.js";import{U as N}from"./api-CmR8jQ8C.js";import{B as m}from"./button-B-x8lPpO.js";function y({quotation:s}){const t=x({resolver:b(N),defaultValues:{validityDate:s.validityDate?.slice(0,10),items:s.items.map(i=>({itemName:i.itemName,description:i.description,quantity:Number(i.quantity),unitPrice:String(i.unitPrice),tax:String(i.tax??"0")}))}}),{fields:o,append:n,remove:c}=g({control:t.control,name:"items"}),d=async i=>{await l.update(s.id,i),u.success("Quotation updated!")};return e.jsxs("form",{onSubmit:t.handleSubmit(d),className:"space-y-6 bg-white/5 p-6 rounded-xl border border-white/10 backdrop-blur-xl",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-white text-sm",children:"Validity Date"}),e.jsx(r,{type:"date",...t.register("validityDate"),className:"bg-white/10 text-white"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Items"}),o.map((i,a)=>e.jsxs("div",{className:"p-4 bg-white/10 border border-white/10 rounded-xl space-y-3",children:[e.jsx(r,{placeholder:"Item Name",...t.register(`items.${a}.itemName`),className:"bg-white/10 text-white"}),e.jsx(r,{placeholder:"Description",...t.register(`items.${a}.description`),className:"bg-white/10 text-white"}),e.jsx(r,{type:"number",placeholder:"Quantity",...t.register(`items.${a}.quantity`,{valueAsNumber:!0}),className:"bg-white/10 text-white"}),e.jsx(r,{placeholder:"Unit Price",...t.register(`items.${a}.unitPrice`),className:"bg-white/10 text-white"}),e.jsx(r,{placeholder:"Tax",...t.register(`items.${a}.tax`),className:"bg-white/10 text-white"}),e.jsx(m,{type:"button",variant:"destructive",className:"bg-red-700/50",onClick:()=>c(a),children:"Remove"})]},i.id)),e.jsx(m,{type:"button",className:"bg-linear-to-r from-blue-500 to-purple-600",onClick:()=>n({itemName:"",description:"",quantity:1,unitPrice:"0",tax:"0"}),children:"+ Add Item"})]}),e.jsx(m,{className:"w-full bg-linear-to-r from-pink-500 to-purple-600",children:"Save Changes"})]})}function D(){const{id:s}=p({from:"/dashboard/quotations/$id/edit"}),{data:t,isLoading:o}=h({queryKey:["quotation-edit",s],queryFn:()=>l.getOne(s).then(n=>n.data)});return o?e.jsx("div",{className:"p-10 text-white",children:"Loading..."}):e.jsxs("div",{className:"p-8 text-white",children:[e.jsx("h1",{className:"text-3xl bg-linear-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent font-bold mb-6",children:"Edit Quotation"}),e.jsx(y,{quotation:t})]})}export{D as component};
